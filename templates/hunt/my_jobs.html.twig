{% extends 'base.html.twig' %}

{% block title %}Mes Candidatures{% endblock %}

{% block body %}
<style>
    .container { max-width: 900px; margin: 3rem auto; padding: 0 1rem; font-family: 'Inter', sans-serif; }
    
    .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem; }
    .title { font-size: 1.8rem; font-weight: 800; color: #1e293b; }
    
    .btn-back { text-decoration: none; color: #64748b; font-weight: 500; display: flex; align-items: center; gap: 0.5rem; }
    .btn-back:hover { color: #1e293b; }

    .job-list { display: grid; gap: 1rem; }
    
    .saved-job { 
        background: white; 
        padding: 1.5rem; 
        border-radius: 12px; 
        border: 1px solid #e2e8f0; 
        display: flex; 
        justify-content: space-between; 
        align-items: center; 
        transition: transform 0.2s, box-shadow 0.2s;
    }
    .saved-job:hover { transform: translateY(-2px); box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05); }

    .job-info h3 { margin: 0 0 0.5rem 0; font-size: 1.1rem; color: #1e293b; }
    .job-meta { font-size: 0.9rem; color: #64748b; display: flex; gap: 1rem; }
    
    .btn-view { 
        background: #f1f5f9; color: #475569; 
        padding: 0.5rem 1rem; border-radius: 8px; 
        text-decoration: none; font-weight: 600; font-size: 0.9rem;
    }
    .btn-view:hover { background: #e2e8f0; color: #1e293b; }

    .empty-state { text-align: center; padding: 4rem; color: #94a3b8; border: 2px dashed #e2e8f0; border-radius: 16px; }
</style>

<div class="container">
    <div class="header">
        <h1 class="title">üìÇ Mes Candidatures</h1>
        <a href="{{ path('app_hunt') }}" class="btn-back">‚Üê Retour recherche</a>
    </div>

    {% if jobs is empty %}
        <div class="empty-state">
            <h3>Aucune candidature sauvegard√©e</h3>
            <p>G√©n√©rez une lettre de motivation sur une offre pour la voir appara√Ætre ici.</p>
        </div>
    {% else %}
        <div class="job-list">
            {% for job in jobs %}
                <div class="saved-job">
                    <div class="job-info">
                        <h3>{{ job.title }}</h3>
                        <div class="job-meta">
                            <span>üìÖ Sauvegard√© le {{ job.createdAt|date('d/m/Y') }}</span>
                            {% if job.letter %}
                                <span style="color: #166534; background: #dcfce7; padding: 0 8px; border-radius: 99px; font-size: 0.8rem;">
                                    ‚úÖ Lettre pr√™te
                                </span>
                            {% endif %}
                        </div>
                    </div>
                    <div>
                        {# On utilise l'ID de la BDD pour retourner voir le d√©tail et la lettre #}
                        {# ATTENTION : Comme c'est un ID BDD (ex: 17) et pas France Travail, il faut que le controller g√®re √ßa #}
                        {# Heureusement, notre m√©thode 'show' commence par v√©rifier la BDD, donc √ßa marche ! #}
                        <a href="{{ path('app_job_show', {id: job.link|split('/')|last }) }}" class="btn-view">
                            Voir le dossier ‚Üí
                        </a>
                    </div>
                </div>
            {% endfor %}
        </div>
    {% endif %}
</div>
{% endblock %}
{% extends 'base.html.twig' %}

{% block title %}Mes Candidatures
{% endblock %}

{% block body %}
	{% block stylesheets %}
		{{ parent() }}
		<link rel="stylesheet" href="{{ asset('styles/my_jobs.css') }}">
	{% endblock %}

	<div class="container">
		<div class="header">
			<h1 class="title">ğŸ“‚ Mes Candidatures</h1>
			<a href="{{ path('app_hunt') }}" class="btn-back">â† Retour recherche</a>
		</div>

		{% if jobs is empty %}
			<div class="empty-state">
				<h3>Aucune candidature sauvegardÃ©e</h3>
				<p>GÃ©nÃ©rez une lettre de motivation sur une offre pour la voir apparaÃ®tre ici.</p>
			</div>
		{% else %}
			<div class="job-list">
				{% for job in jobs %}
					<div class="saved-job">
						<div class="job-info">
							<h3>{{ job.title }}</h3>
							<div class="job-meta">
								<span>ğŸ“… SauvegardÃ© le
									{{ job.createdAt|date('d/m/Y') }}</span>
								{% if job.letter %}
									<span style="color: #166534; background: #dcfce7; padding: 0 8px; border-radius: 99px; font-size: 0.8rem;">
										âœ… Lettre prÃªte
									</span>
								{% endif %}
							</div>
						</div>
						<div>
							{# On utilise l'ID de la BDD pour retourner voir le dÃ©tail et la lettre #}
							{# ATTENTION : Comme c'est un ID BDD (ex: 17) et pas France Travail, il faut que le controller gÃ¨re Ã§a #}
							{# Heureusement, notre mÃ©thode 'show' commence par vÃ©rifier la BDD, donc Ã§a marche ! #}
								<a href="{{ path('app_job_show', {id: job.link|split('/')|last }) }}" class="btn-view"> Afficher l'annonce â†’
							</a>
							<a href="{{ path('app_job_toggle_applied', {id: job.id}) }}" class="btn-view" style="margin-left: 0.5rem; background: {{ job.applied ? '#dcfce7' : '#f1f5f9' }}; color: {{ job.applied ? '#166534' : '#475569' }};">
								{{ job.applied ? 'âœ… PostulÃ©' : 'â¬œ Non postulÃ©' }}
							</a>
						</div>
					</div>
				{% endfor %}
			</div>
		{% endif %}
	</div>
{% endblock %}
